version: "3.8"
services:
    redis:
        container_name: sad_redis
        image: redis
        restart: always
        volumes:
            - redis:/data
    mysql:
        container_name: sad_mysql
        command: mysqld --default-authentication-plugin=mysql_native_password
        restart: unless-stopped
        image: mysql:latest
        ports:
            - 3306:3306
        environment:
            MYSQL_ROOT_PASSWORD: "admin"
            MYSQL_USER: "admin"
            MYSQL_PASS: "test"
        volumes:
            - ./data-volume:/var/lib/mysql
            - ./data-source:/data

    # metabase:
    #     container_name: sad_metabase
    #     restart: unless-stopped
    #     image: metabase/metabase
    #     ports:
    #         - 3010:3000
    superset:
        container_name: sad_superset
        image: amancevice/superset
        restart: always
        depends_on:
            - mysql
        environment:
            MAPBOX_API_KEY: ${MAPBOX_API_KEY}
        ports:
            - "8088:8088"
        volumes:
            - ./superset_config.py:/etc/superset/superset_config.py

volumes:
    data-volume:
    data-source:
    redis:
